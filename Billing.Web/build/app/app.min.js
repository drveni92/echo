!function(){function e(){return null!==credentials&&0!==credentials.currentUser.id}var t=angular.module("Billing",["ngRoute","ui.bootstrap","ngIdle","ngAnimate","LocalStorageModule","oi.select","nvd3"]);REGIONS=["Banja Luka","Bihac","Doboj","Mostar","Sarajevo","Trebinje","Tuzla","Zenica"],credentials={token:"",expiration:"",currentUser:{id:0,name:"",roles:[]}},redirectTo="/",t.config(["$routeProvider",function(e){e.when("/dashboard",{templateUrl:"app/view/reports/dashboard.html",controller:"ReportDashboardController"}).when("/login",{templateUrl:"app/components/sessions/templates/login.html",controller:"LoginController"}).when("/logout",{template:"",controller:"LogoutController"}).when("/agents",{templateUrl:"app/view/agents/agents.html",controller:"AgentsController"}).when("/agents/:id",{templateUrl:"app/view/agents/show.html",controller:"AgentShowController"}).when("/products",{templateUrl:"app/view/products/product.html",controller:"ProductsController"}).when("/customers",{templateUrl:"app/view/customers/customer.html",controller:"CustomersController"}).when("/report/customers",{templateUrl:"app/view/reports/customer.html",controller:"ReportCustomersController"}).when("/report/categories",{templateUrl:"app/view/reports/category.html",controller:"ReportCategoriesController"}).when("/report/agents/regions",{templateUrl:"app/view/reports/agentsregions.html",controller:"ReportAgentsRegionsController"}).when("/report/customers/categories",{templateUrl:"app/view/reports/customerscategories.html",controller:"ReportCustomersCategoriesController"}).when("/report/maps",{templateUrl:"app/view/reports/maps.html",controller:"ReportsMapController"}).when("/towns",{templateUrl:"app/view/towns/town.html",controller:"TownsController"}).when("/categories",{templateUrl:"app/view/categories/category.html",controller:"CategoriesController"}).when("/stocks",{templateUrl:"app/view/stocks/stock.html",controller:"StocksController"}).when("/suppliers",{templateUrl:"app/view/suppliers/supplier.html",controller:"SuppliersController"}).when("/shippers",{templateUrl:"app/view/shippers/shipper.html",controller:"ShippersController"}).when("/procurements",{templateUrl:"app/view/procurements/procurements.html",controller:"ProcurementsController"}).when("/invoices",{templateUrl:"app/view/invoices/invoices.html",controller:"InvoicesController"}).when("/invoices/new",{templateUrl:"app/view/invoices/new.html",controller:"InvoicesNewController"}).when("/invoices/:id",{templateUrl:"app/view/invoices/new.html",controller:"InvoicesNewController"}).when("/invoice/:id",{templateUrl:"app/view/invoices/show_invoice.html",controller:"InvoiceShowController"}).when("/report/regions",{templateUrl:"app/view/reports/salesbyregion.html",controller:"SalesByRegionController"}).when("/invoicesreview",{templateUrl:"app/view/reports/invoicesreview.html",controller:"InvoicesReviewController"}).otherwise({redirectTo:"/dashboard"})}]).run(["$rootScope","$location",function(t,n){t.$on("$routeChangeStart",function(t,a,o){e()||"app/components/sessions/templates/login.html"!=a.templateUrl&&(redirectTo=n.path(),n.path("/login"))}),t.authenticated=e}])}(),function(){angular.module("Billing").factory("DataFactory",["$http","$rootScope","ToasterService",function(e,t,n){var a=BillingConfig.source;return e.defaults.headers.common.Token=credentials.token,e.defaults.headers.common.ApiKey=BillingConfig.apiKey,{promise:function(t){return e.get(a+t)},list:function(t,o,r){e.get(a+t,{params:r}).then(function(e){return o(e.data)},function(e){n.pop("error","Error",e.data.message)})},read:function(t,o,r){e.get(a+t+"/"+o).then(function(e){return r(e.data)},function(e){n.pop("error","Error",e.data.message)})},insert:function(t,o,r,i){e({method:"post",url:a+t,data:o,params:i}).then(function(e){return r(e.data)},function(e){n.pop("error","Error",e.data.message)})},update:function(t,o,r,i){e({method:"put",url:a+t+"/"+o,data:r}).then(function(e){return i(e.data)},function(e){n.pop("error","Error",e.data.message)})},delete:function(t,o,r){e({method:"delete",url:a+t+"/"+o}).then(function(e){return r(e.data)},function(e){n.pop("error","Error",e.data.message)})}}}])}(),function(){angular.module("Billing").factory("httpInterceptor",["$q","$rootScope",function(e,t){var n=0;return{request:function(a){return n++,-1===a.url.indexOf("invoices/automatic/nocheck")&&t.$broadcast("loader_show"),a||e.when(a)},response:function(a){return 0==--n&&t.$broadcast("loader_hide"),a||e.when(a)},responseError:function(a){return--n||t.$broadcast("loader_hide"),e.reject(a)}}}]).config(["$httpProvider",function(e){e.interceptors.push("httpInterceptor")}])}(),function(){angular.module("Billing").controller("AgentShowController",["$scope","$route","$routeParams","$uibModal","DataFactory","AgentsFactory","ToasterService",function(e,t,n,a,o,r,i){var s=n.id;s&&o.read("agents",s,function(t){e.agent=r.fullagent(t)}),$("#profile-image1").on("click",function(){$("#profile-image-upload").click()}),e.edit=function(e){a.open({animation:!0,focus:!1,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"app/view/agents/changepassword.html",controller:"ModalInstanceController",controllerAs:"$modal",resolve:{data:function(){return $.extend(!0,{},e)}}}).result.then(function(e){o.update("agents/changepassword",e.id,e,function(e){i.pop("success","Success",e)})},function(e){i.pop("error","Error",e)})}}])}(),function(){angular.module("Billing").controller("AgentsController",["$scope","$http","$uibModal","DataFactory","AgentsFactory","ToasterService",function(e,t,n,a,o,r){function i(){e.pageParams.page=e.pageParams.page-1,a.list("agents",function(t){e.agents=t.list,e.pageParams.totalItems=t.totalItems,e.pageParams.page=t.currentPage+1},e.pageParams)}e.maxPagination=BillingConfig.maxPagination,e.pageParams={page:1,showPerPage:BillingConfig.showPerPage,sortType:"name",sortReverse:!1,totalItems:0},e.sort=function(t){e.pageParams.sortType===t&&(e.pageParams.sortReverse=!e.pageParams.sortReverse),e.pageParams.sortType=t,i()},e.search=function(){(e.pageParams.name.toString().length>2||0===e.pageParams.name.toString().length)&&i()},e.showItems=function(){i()},e.pageChanged=function(){i()},i(),e.new=function(){n.open({animation:!0,focus:!1,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"app/view/agents/new.html",controller:"ModalInstanceController",controllerAs:"$modal",resolve:{data:function(){return o.empty()}}}).result.then(function(e){a.insert("agents",o.agent(e),function(e){i()})},function(){})},e.edit=function(e){n.open({animation:!0,focus:!1,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"app/view/agents/edit.html",controller:"ModalInstanceController",controllerAs:"$modal",resolve:{data:function(){return $.extend(!0,{},e)}}}).result.then(function(e){a.update("agents",e.id,o.agent(e),function(e){i()})},function(){i()})},e.delete=function(e){n.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"app/view/agents/delete.html",controller:"ModalInstanceController",controllerAs:"$modal",resolve:{data:function(){return e}}}).result.then(function(e){a.delete("agents",e.id,function(e){r.pop("success","Success","Agent deleted"),i()})},function(){})}}])}(),function(){angular.module("Billing").controller("CategoriesController",["$scope","$http","$uibModal","DataFactory","ToasterService","CategoriesFactory",function(e,t,n,a,o,r){function i(){e.pageParams.page=e.pageParams.page-1,a.list("categories",function(t){e.categories=t.list,e.pageParams.totalItems=t.totalItems,e.pageParams.page=t.currentPage+1},e.pageParams)}e.get=function(t){e.category=t,e.showCategory=!0},e.maxPagination=BillingConfig.maxPagination,e.pageParams={page:1,showPerPage:BillingConfig.showPerPage,sortType:"name",sortReverse:!1,totalItems:0},e.sort=function(t){e.pageParams.sortType===t&&(e.pageParams.sortReverse=!e.pageParams.sortReverse),e.pageParams.sortType=t,i()},e.search=function(){(e.pageParams.name.toString().length>2||0===e.pageParams.name.toString().length)&&i()},e.showItems=function(){i()},e.pageChanged=function(){i()},i(),e.new=function(){n.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"app/view/categories/new.html",controller:"ModalInstanceController",controllerAs:"$modal",resolve:{data:function(){return r.empty()}}}).result.then(function(e){a.insert("categories",r.category(e),function(e){o.pop("success","Success","Category added"),i()})},function(){})},e.edit=function(e){n.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"app/view/categories/edit.html",controller:"ModalInstanceController",controllerAs:"$modal",resolve:{data:function(){return $.extend(!0,{},e)}}}).result.then(function(e){a.update("categories",e.id,r.category(e),function(e){o.pop("success","Success","Category saved"),i()})},function(){i()})},e.delete=function(e){n.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"app/view/categories/delete.html",controller:"ModalInstanceController",controllerAs:"$modal",resolve:{data:function(){return e}}}).result.then(function(e){a.delete("categories",e.id,function(e){o.pop("success","Success","Category deleted"),i()})},function(){})}}])}(),function(){angular.module("Billing").controller("CustomersController",["$scope","$http","$uibModal","DataFactory","ToasterService","CustomersFactory",function(e,t,n,a,o,r){function i(){e.pageParams.page=e.pageParams.page-1,a.list("customers",function(t){e.customers=t.list,e.pageParams.totalItems=t.totalItems,e.pageParams.page=t.currentPage+1},e.pageParams)}e.maxPagination=BillingConfig.maxPagination,e.pageParams={page:1,showPerPage:BillingConfig.showPerPage,sortType:"name",sortReverse:!1,totalItems:0},e.sort=function(t){e.pageParams.sortType===t&&(e.pageParams.sortReverse=!e.pageParams.sortReverse),e.pageParams.sortType=t,i()},e.search=function(){(e.pageParams.name.toString().length>2||0===e.pageParams.name.toString().length)&&i()},e.showItems=function(){i()},e.pageChanged=function(){i()},i(),e.new=function(){n.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"app/view/customers/new.html",controller:"ModalInstanceController",controllerAs:"$modal",resolve:{data:function(){return r.empty()}}}).result.then(function(e){a.insert("customers",r.customer(e),function(e){o.pop("success","Success","Customer added"),i()})},function(){})},e.show=function(e){n.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"app/view/customers/show.html",controller:"ModalInstanceController",controllerAs:"$modal",resolve:{data:function(){return e}}}).result.then(function(){},function(){})},e.edit=function(e){n.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"app/view/customers/edit.html",controller:"ModalInstanceController",controllerAs:"$modal",resolve:{data:function(){return $.extend(!0,{},e)}}}).result.then(function(e){a.update("customers",e.id,r.customer(e),function(e){o.pop("success","Success","Customer saved"),i()})},function(){i()})},e.delete=function(e){n.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"app/view/customers/delete.html",controller:"ModalInstanceController",controllerAs:"$modal",resolve:{data:function(){return e}}}).result.then(function(e){a.delete("customers",e.id,function(e){o.pop("success","Success","Customer deleted"),i()})},function(){})}}])}(),function(){angular.module("Billing").controller("InvoicesNewController",["$scope","$uibModal","$route","$routeParams","DataFactory","ToasterService","$location","InvoicesFactory",function(e,t,n,a,o,r,i,s){e.states=BillingConfig.states,e.active=0,e.step2=!0,e.step3=!0,document.getElementById("step2").style.pointerEvents="none",document.getElementById("step3").style.pointerEvents="none",e.invoice=s.empty();var l=a.id?a.id:null;l&&o.read("invoices",l,function(t){e.invoice=t,e.invoice.date=new Date(e.invoice.date)}),e.add_new_item=function(t){for(var n=!1,a=e.invoice.items.length-1;a>=0;a--)e.invoice.items[a].product.name===t.name&&e.invoice.items[a].price===t.price&&(n=!0,e.invoice.items[a].quantity+=t.quantity);n||e.invoice.items.unshift(s.item(t)),r.pop("info","Info","Item added")},e.deleteItem=function(t){for(var n=e.invoice.items.length-1;n>=0;n--)e.invoice.items[n].product.name===t.product.name&&e.invoice.items[n].price===t.price&&e.invoice.items.splice(n,1);r.pop("success","Success","Item deleted")},e.open=function(){e.popup.opened=!0},e.popup={opened:!1},e.setActieveTab=function(t){2===t&&(e.invoice=s.invoice(e.invoice)),e.active=t},e.getProducts=function(e){var t="products/"+e;return o.promise(t).then(function(e){return e.data.list})},e.getCustomers=function(e){var t="customers/"+e;return o.promise(t).then(function(e){return e.data.list})},e.getShippers=function(e){var t="shippers/"+e;return o.promise(t).then(function(e){return e.data.list})},e.save=function(){null===l?o.insert("invoices",e.invoice,function(t){t&&(e.invoice=s.invoice(t),r.pop("success","Success","Invoice added"),i.path("/invoice/"+t.id))}):o.update("invoices",e.invoice.id,e.invoice,function(t){t&&(e.invoice=s.invoice(t),r.pop("success","Success","Invoice saved"),i.path("/invoice/"+t.id))})};var c=$("div.setup-panel div a"),u=$(".setup-content"),d=$(".nextBtn");u.hide(),c.click(function(e){e.preventDefault();var t=$($(this).attr("href")),n=$(this);n.hasClass("disabled")||(c.removeClass("btn-primary").addClass("btn-default"),n.addClass("btn-primary"),u.hide(),t.show(),t.find("input:eq(0)").focus())}),d.click(function(){var t=$(this).closest(".setup-content"),n=t.attr("id"),a=$('div.setup-panel div a[href="#'+n+'"]').parent().next().children("a"),o=t.find("input[type='text'],input[type='url']"),r=!0;$(".form-group").removeClass("has-error");for(var i=0;i<o.length;i++)o[i].validity.valid||(r=!1,$(o[i]).closest(".form-group").addClass("has-error"));r&&"step-1"===n&&(a.removeAttr("disabled").trigger("click"),e.step2=!1,document.getElementById("step2").style.pointerEvents="auto",e.step3=!1,document.getElementById("step3").style.pointerEvents="auto",e.invoice=s.invoice(e.invoice)),e.invoice=s.invoice(e.invoice),"step-2"===n&&a.removeAttr("disabled").trigger("click")}),$("div.setup-panel div a.btn-primary").trigger("click")}])}(),function(){angular.module("Billing").controller("InvoiceShowController",["$scope","$route","$routeParams","DataFactory","InvoicesService","$uibModal","ToasterService",function(e,t,n,a,o,r,i){var s=n.id;s&&a.read("invoices",s,function(t){e.invoice=t,e.invoice.date=new Date(e.invoice.date)}),e.download=function(){o.download(s)},e.send=function(){r.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"app/view/invoices/mail.html",controller:"ModalInstanceController",controllerAs:"$modal",resolve:{data:function(){return null}}}).result.then(function(e){e.InvoiceId=s,a.insert("invoices/mail",e,function(e){i.pop("success","Success",e)})},function(){})}}])}(),function(){angular.module("Billing").controller("InvoicesController",["$scope","$uibModal","DataFactory","InvoicesService","ToasterService","$rootScope",function(e,t,n,a,o,r){function i(){e.pageParams.page=e.pageParams.page-1,e.showAdvancedSearch?n.insert("invoices/search",e.searchParams,function(t){e.invoices=t.list,e.pageParams.totalItems=t.totalItems,e.pageParams.page=t.currentPage+1},e.pageParams):n.list("invoices",function(t){e.invoices=t.list,e.pageParams.totalItems=t.totalItems,e.pageParams.page=t.currentPage+1},e.pageParams)}e.states=BillingConfig.states,e.userId=credentials.currentUser.id,e.maxPagination=BillingConfig.maxPagination,e.showAdvancedSearch=!1,e.searchParams={agent:"",customer:"",status:""},e.pageParams={invoiceno:"",page:1,showPerPage:BillingConfig.showPerPage,sortType:"total",sortReverse:!1,totalItems:0},e.advancedSearch=function(){e.showAdvancedSearch=!e.showAdvancedSearch,!1===e.showAdvancedSearch&&i()},e.sort=function(t){e.pageParams.sortType===t&&(e.pageParams.sortReverse=!e.pageParams.sortReverse),e.pageParams.sortType=t,i()},e.advancedSearchSubmit=function(){i()},e.search=function(){(e.pageParams.invoiceno.toString().length>2||0===e.pageParams.invoiceno.toString().length)&&i()},e.showItems=function(){i()},e.pageChanged=function(){i()},i(),e.download=function(e){a.download(e)},e.checkUpdates=function(){n.list("invoices/automatic/check",function(e){r.invoicesCount=0,t.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"app/view/invoices/updated.html",controller:"ModalInstanceController",controllerAs:"$modal",size:"lg",resolve:{data:function(){return e}}}).result.then(function(){},function(){})})},e.show=function(a){t.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"app/view/invoices/show.html",controller:"ModalInstanceController",controllerAs:"$modal",scope:e,size:"lg",resolve:{data:function(){return a}}}).result.then(function(e){t.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"app/view/invoices/mail.html",controller:"ModalInstanceController",controllerAs:"$modal",resolve:{data:function(){return null}}}).result.then(function(t){t.InvoiceId=e.id,n.insert("invoices/mail",t,function(e){o.pop("success","Success",e)})},function(){})},function(){})},e.show_history=function(n){t.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"app/view/invoices/show_histories.html",controller:"ModalInstanceController",controllerAs:"$modal",scope:e,size:"lg",resolve:{data:function(){return n}}}).result.then(function(){},function(){})},e.nextState=function(r,s){null===s&&(s=!1);var l="invoices/"+r.id+"/next/"+s;a.next(l,function(t){o.pop("info","Invoice "+r.invoiceNo,"New state of the invoice is "+e.states[t.status+1]),i()},function(e){o.pop("error","Error",e.data.message),t.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"app/view/invoices/automatic.html",controller:"ModalInstanceController",controllerAs:"$modal",resolve:{data:function(){return r}}}).result.then(function(e){n.read("invoices/automatic",e.id,function(e){o.pop("success","Success",e)})},function(){})})},e.delete=function(e){t.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"app/view/invoices/delete.html",controller:"ModalInstanceController",controllerAs:"$modal",resolve:{data:function(){return e}}}).result.then(function(e){n.delete("invoices",e.id,function(e){o.pop("success","Success","Invoice deleted"),i()})},function(){})}}])}(),function(){angular.module("Billing").controller("EchoController",["$scope","Idle","$uibModal","$location",function(e,t,n,a){function o(){e.warning&&(e.warning.close(),e.warning=null)}t.watch(),e.started=!0,e.$on("IdleStart",function(){"/login"!==a.path()&&(o(),e.warning=n.open({templateUrl:"app/view/keepalive/warning.html",windowClass:"modal-danger",countdownBar:!0,animation:!0}))}),e.$on("IdleEnd",function(){"/login"!==a.path()&&o()}),e.$on("IdleTimeout",function(){"/login"!==a.path()&&(o(),window.location.reload())})}]).config(["IdleProvider","KeepaliveProvider",function(e,t){e.idle(3600),e.timeout(20),t.interval(20)}])}(),function(){angular.module("Billing").controller("ProcurementsController",["$scope","$http","$uibModal","DataFactory","ToasterService","ProcurementsFactory",function(e,t,n,a,o,r){function i(){e.pageParams.page=e.pageParams.page-1,a.list("procurements",function(t){e.procurements=t.list,e.pageParams.totalItems=t.totalItems,e.pageParams.page=t.currentPage+1},e.pageParams)}e.maxPagination=BillingConfig.maxPagination,e.pageParams={page:1,showPerPage:BillingConfig.showPerPage,sortType:"date",sortReverse:!0,totalItems:0},e.sort=function(t){e.pageParams.sortType===t&&(e.pageParams.sortReverse=!e.pageParams.sortReverse),e.pageParams.sortType=t,i()},e.search=function(){(e.pageParams.product.toString().length>2||0===e.pageParams.product.toString().length)&&i()},e.showItems=function(){i()},e.pageChanged=function(){i()},i(),e.new=function(){n.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"app/view/procurements/new.html",controller:"ModalInstanceController",controllerAs:"$modal",resolve:{data:function(){return r.empty()}}}).result.then(function(e){a.insert("procurements",r.procurement(e),function(e){o.pop("success","Success","Procurement added"),i()})},function(){})},e.show=function(e){n.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"app/view/procurements/show.html",controller:"ModalInstanceController",controllerAs:"$modal",resolve:{data:function(){return e}}}).result.then(function(){},function(){})},e.edit=function(e){e.date=new Date(e.date),n.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"app/view/procurements/edit.html",controller:"ModalInstanceController",controllerAs:"$modal",resolve:{data:function(){return $.extend(!0,{},e)}}}).result.then(function(e){a.update("procurements",e.id,r.procurement(e),function(e){o.pop("success","Success","Procurement saved"),i()})},function(){i()})},e.delete=function(e){n.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"app/view/procurements/delete.html",controller:"ModalInstanceController",controllerAs:"$modal",resolve:{data:function(){return e}}}).result.then(function(e){a.delete("procurements",e.id,function(e){o.pop("success","Success","Procurement deleted"),i()})},function(){})}}])}(),function(){angular.module("Billing").controller("ModalInstanceController",["$uibModalInstance","$scope","DataFactory","data","$timeout",function(e,t,n,a,o){var r=this;r.data=a,r.regions=BillingConfig.regions,r.states=BillingConfig.states,r.ok=function(){e.close(r.data)},r.cancel=function(){e.dismiss("cancel")},r.getSuppliers=function(e){var t="suppliers/"+e;return n.promise(t).then(function(e){return e.data.list})},r.getProducts=function(e){var t="products/"+e;return n.promise(t).then(function(e){return e.data.list})},r.getTowns=function(e){var t="towns/"+e;return n.promise(t).then(function(e){return e.data.list})},r.getCategories=function(e){var t="categories/"+e;return n.promise(t).then(function(e){return e.data.list})}}])}(),function(){angular.module("Billing").controller("ProductsController",["$scope","$http","$uibModal","DataFactory","ToasterService","ProductsFactory",function(e,t,n,a,o,r){function i(){e.pageParams.page=e.pageParams.page-1,a.list("products",function(t){e.products=t.list,e.pageParams.totalItems=t.totalItems,e.pageParams.page=t.currentPage+1},e.pageParams)}e.maxPagination=BillingConfig.maxPagination,e.pageParams={page:1,showPerPage:BillingConfig.showPerPage,sortType:"name",sortReverse:!1,totalItems:0},e.sort=function(t){e.pageParams.sortType===t&&(e.pageParams.sortReverse=!e.pageParams.sortReverse),e.pageParams.sortType=t,i()},e.search=function(){(e.pageParams.name.toString().length>2||0===e.pageParams.name.toString().length)&&i()},e.showItems=function(){i()},e.pageChanged=function(){i()},i(),e.new=function(){n.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"app/view/products/new.html",controller:"ModalInstanceController",controllerAs:"$modal",resolve:{data:function(){return r.empty()}}}).result.then(function(e){a.insert("products",r.product(e),function(e){o.pop("success","Success","Product added"),i()})},function(){})},e.show=function(e){n.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"app/view/products/show.html",controller:"ModalInstanceController",controllerAs:"$modal",resolve:{data:function(){return e}}}).result.then(function(){},function(){})},e.edit=function(e){n.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"app/view/products/edit.html",controller:"ModalInstanceController",controllerAs:"$modal",resolve:{data:function(){return $.extend(!0,{},e)}}}).result.then(function(e){a.update("products",e.id,r.product(e),function(e){o.pop("success","Success","Product saved"),i()})},function(){i()})},e.delete=function(e){n.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"app/view/products/delete.html",controller:"ModalInstanceController",controllerAs:"$modal",resolve:{data:function(){return e}}}).result.then(function(e){a.delete("products",e.id,function(e){o.pop("success","Success","Product deleted"),i()})},function(){})}}])}(),function(){angular.module("Billing").controller("ReportAgentsRegionsController",["$scope","DataFactory","ToasterService",function(e,t,n){var a=null;e.dateOptions={maxDate:new Date,startingDay:1},e.selectedOption="0",e.startDateOpened=!1,e.endDateOpened=!1,e.openStartDate=function(){e.startDateOpened=!0},e.openEndDate=function(){e.endDateOpened=!0},e.dates={endDate:new Date,startDate:new Date},e.dates.startDate.setMonth(e.dates.startDate.getMonth()-7),e.options={chart:{type:"multiBarChart",height:650,margin:{top:20,right:100,bottom:250,left:100},x:function(e){return e.x.split(/(?=[A-Z])/).join(" ").toLowerCase()},valueFormat:function(e){return d3.format("$,.2f")(e)},clipEdge:!0,duration:500,stacked:!1,xAxis:{rotateLabels:30},yAxis:{axisLabelDistance:50}}},e.data=[],e.createGraph=function(){t.insert("salesbyagentsregions",e.dates,function(e){a=e,o(e)})};var o=function(t){e.data=[];for(var n=t.agents.length-1;n>=0;n--){for(var a={key:t.agents[n].name,values:[]},o=t.regions.length-1;o>=0;o--){var r=String(t.regions[o].region);a.values.push({x:r,y:t.agents[n].sales[r]})}e.data.push(a)}};e.updateGraph=function(){o(a)},e.createGraph()}])}(),function(){angular.module("Billing").controller("ReportCategoriesController",["$scope","DataFactory","ToasterService","$uibModal","$timeout",function(e,t,n,a,o){var r=null;e.$watch("isMenuOpened",function(){null!==r&&o(function(){i(r)},800)}),e.dateOptions={maxDate:new Date,startingDay:1},e.selectedOption="0",e.startDateOpened=!1,e.endDateOpened=!1,e.openStartDate=function(){e.startDateOpened=!0},e.openEndDate=function(){e.endDateOpened=!0},e.dates={endDate:new Date,startDate:new Date,id:0},e.dates.startDate.setMonth(e.dates.startDate.getMonth()-5),e.options={chart:{type:"discreteBarChart",height:550,x:function(e){return e.label1},y:function(e){return e.value},margin:{top:20,right:100,bottom:100,left:100},showValues:!0,duration:500,yAxis:{tickFormat:function(e){return d3.format("$,.2f")(e)}},forceY:2e5,staggerLabels:!0,callback:function(n){n.discretebar.dispatch.on("elementClick",function(n){e.dates.id=n.data.label2,t.insert("salesbyproduct",e.dates,function(e){a.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"app/view/reports/salesbyproduct.html",controller:"ModalInstanceController",controllerAs:"$modal",size:"lg",resolve:{data:function(){return e}}}).result.then(function(){},function(){})})})}},title:{enable:!0,text:"Sales by categories"}},e.createGraph=function(){t.insert("salesbycategory",e.dates,function(e){r=e,i(e)})};var i=function(t){for(var n=[],a=t.sales.length-1;a>=0;a--)n.push({label1:t.sales[a].name,label2:t.sales[a].id,value:t.sales[a].total});e.data=[{key:"Sales By Cateogry",values:n}]};e.updateGraph=function(){i(r)},e.createGraph()}])}(),function(){angular.module("Billing").controller("ReportCustomersCategoriesController",["$scope","DataFactory","ToasterService",function(e,t,n){function a(){t.insert("salesbycustomerscategories",{startDate:e.dates.startDate,endDate:e.dates.endDate,page:e.currentPage-1},function(t){e.salesbycustomerscategories=t.data,e.totalItems=t.totalItems,e.currentPage=t.currentPage+1})}var o=!1;e.dates={endDate:new Date,startDate:new Date},e.dateOptions={maxDate:new Date,startingDay:1},e.pageChanged=function(){a()},e.dates.startDate.setMonth(e.dates.startDate.getMonth()-12),a(),e.dateOptions={maxDate:new Date,startingDay:1},e.selectedOption="0",e.startDateOpened=!1,e.endDateOpened=!1,e.openStartDate=function(){e.startDateOpened=!0},e.openEndDate=function(){e.endDateOpened=!0},e.$watch(function(e){return e.dates.startDate},function(){o&&a()}),e.$watch(function(e){return e.dates.endDate},function(){o?a():o=!0})}])}(),function(){angular.module("Billing").controller("ReportCustomersController",["$scope","DataFactory","ToasterService",function(e,t,n){function a(){t.insert("salesbycustomer",{startDate:e.dates.startDate,endDate:e.dates.endDate,page:e.currentPage-1},function(t){e.salesbycustomer=t.data,e.totalItems=t.totalItems,e.currentPage=t.currentPage+1})}e.maxPagination=BillingConfig.maxPagination;var o=!1;e.dates={endDate:new Date,startDate:new Date},e.dateOptions={maxDate:new Date,startingDay:1},e.pageChanged=function(){a()},e.dates.startDate.setMonth(e.dates.startDate.getMonth()-12),a(),e.dateOptions={maxDate:new Date,startingDay:1},e.selectedOption="0",e.startDateOpened=!1,e.endDateOpened=!1,e.openStartDate=function(){e.startDateOpened=!0},e.openEndDate=function(){e.endDateOpened=!0},e.$watch(function(e){return e.dates.startDate},function(){o&&a()}),e.$watch(function(e){return e.dates.endDate},function(){o?a():o=!0})}])}(),function(){angular.module("Billing").controller("ReportDashboardController",["$scope","DataFactory","ToasterService","DashboardFactory","$timeout",function(e,t,n,a,o){function r(){m(f.agentsSales),g(f.burningItems),p(f.categoriesYear),i(f.categoriesMonth),d(f.customers),u(f.invoices),c(f.top5Products),l(f.regionsYear),s(f.regionsMonth)}function i(t){result=a.monthSale(t),e.categoriesmonth={data:result.data,options:result.options}}function s(t){result=a.monthSale(t),e.regionsmonth={data:result.data,options:result.options}}function l(t){result=a.regionsYear(t),e.regionsyear={data:result.data,options:result.options}}function c(t){result=a.products(t),e.products={data:result.data,options:result.options}}function u(t){result=a.invoices(t),e.invoices={data:result.data,options:result.options}}function d(t){result=a.customers(t),e.customers={data:result.data,options:result.options}}function p(t){result=a.categoriesyear(t),e.categoriesYear={data:result.data,options:result.options}}function m(t){result=a.agentsales(t),e.agentsales={data:result.data,options:result.options}}function g(t){result=a.burningitems(t),e.burningitems={data:result.data,options:result.options}}e.title="";var f=null;e.$watch("isMenuOpened",function(){null!=f&&o(function(){r()},800)}),t.list("dashboard",function(t){e.title=t.title,e.noinvoices=t.numberOfInvoices,e.totalMonth=t.monthTotal,e.shipped=t.shippedInvoices,e.nocustomers=t.activeCustomers,f=t,r()})}])}(),function(){angular.module("Billing").controller("InvoicesReviewController",["$scope","DataFactory","$uibModal","ToasterService","$rootScope",function(e,t,n,a,o){function r(){t.insert("invoicereviewpost",{startDate:e.dates.startDate,endDate:e.dates.endDate,id:e.CustomerId},function(t){e.invoicereview=t})}e.states=BillingConfig.states,e.dates={startDate:new Date,endDate:new Date},e.update=function(){r()},function(){t.insert("customers/all",{},function(t){e.Customers=t})}();var i=!1;e.dates.startDate.setMonth(e.dates.startDate.getMonth()-12),e.startDateOpened=!1,e.endDateOpened=!1,e.openStartDate=function(){e.startDateOpened=!0},e.openEndDate=function(){e.endDateOpened=!0},e.$watch(function(e){return e.dates.startDate},function(){i&&r()}),e.$watch(function(e){return e.dates.endDate},function(){i?r():i=!0}),e.show=function(a){t.list("invoicereview/"+a,function(t){e.InvoiceCustomer=t;n.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"app/view/reports/invoicereviewshow.html",controller:"ModalInstanceController",controllerAs:"$modal",scope:e,size:"lg",resolve:{data:function(){return t}}})})}}])}(),function(){angular.module("Billing").controller("ReportsMapController",["$scope","DataFactory","$timeout",function(e,t,n){var a=null;e.result=[],e.currentTown=null,e.selectedItem=null,e.$watch("isMenuOpened",function(){
n(function(){$("#map").empty(),e.loadMap()},800)}),e.loadMap=function(){function t(t){var a,s,c;if(t&&n!==t){var u=o.centroid(t);a=u[0],s=u[1],c=4,n=t,e.updateMapBasic(t.properties.name)}else a=r/2,s=i/2,c=1,n=null;l.selectAll("path").classed("active",n&&function(e){return e===n}),l.transition().duration(750).attr("transform","translate("+r/2+","+i/2+")scale("+c+")translate("+-a+","+-s+")").style("stroke-width",1.5/c+"px")}var n,o,r=parseInt(d3.select("#map").style("width")),i=parseInt(d3.select("#map").style("height")),s=(d3.select(null),d3.select("#map").append("div").attr("class","popup_hidden tooltip"));a=d3.select("#map").append("svg").attr("width",r).attr("height",i),a.append("rect").attr("class","map_background").attr("width",r).attr("height",i);var l=a.append("g").style("stroke-width","1.5px");d3.json("assets/js/maps/municipalities.json",function(e,n){var c=d3.geo.centroid(n),u=[r/2,i/2.5],d=d3.geo.mercator().center(c).scale(6500).translate(u);o=d3.geo.path().projection(d),l.selectAll("path").data(n.features).enter().append("path").attr("d",o).attr("class",function(e){var t="region";return null==e.properties.name&&null==e.properties.name_2&&(t="disabled"),t}).on("click",t).on("mousemove",function(e){var t=e.properties.name;null==t&&null==(t=e.properties.name_2)&&(t=e.properties.name_1);var n=d3.mouse(a.node()).map(function(e){return parseInt(e)});s.classed("popup_hidden",!1).attr("style","left:"+(n[0]+15)+"px; top:"+(n[1]-35)+"px").html(t)}).on("mouseout",function(){s.classed("popup_hidden",!0)})})},e.getTowns=function(e){var n="towns/"+e;return t.promise(n).then(function(e){return e.data.list})},e.updateMapBasic=function(n){n&&t.insert("salesbytown",{name:n},function(t){e.result=t,e.currentTown=t.town,e.currentRegion=t.region,e.selectedItem={name:t.town}})},e.updateMap=function(t){if(e.selectedItem){var t=e.selectedItem.name,n=!1;a.selectAll("path").each(function(e,a){if(-1!==angular.lowercase(e.properties.name).indexOf(angular.lowercase(t))&&!n){d3.select(this).on("click").apply(this,[e,a]),n=!0}})}}}])}(),function(){angular.module("Billing").controller("SalesByRegionController",["$scope","$http","$uibModal","DataFactory","$filter",function(e,t,n,a,o){function r(){l=0,a.insert("salesbyregion",{startDate:e.dates.startDate,endDate:e.dates.endDate},function(t){e.salesbyregion=t,e.sales=t.sales;for(var n=0;n<e.sales.length;n++)if(null!=e.selectedOption&&e.sales[n].name==e.selectedOption.name){index=n,e.sale=e.sales[n],l=1,e.selectedOption=e.sales[n];break}0===l&&(e.sale=null)})}e.dates={startDate:new Date,endDate:new Date};var i,s,l=0;e.openStartDateModal=function(){a.insert("salesbyagent/"+i,{startDate:e.SalesByAgents.startDate,endDate:e.SalesByAgents.endDate,id:i},function(t){e.SalesByAgents=t,e.SalesByAgents.startDate=new Date(e.SalesByAgents.startDate),e.SalesByAgents.endDate=new Date(e.SalesByAgents.endDate)})},e.update=function(){r()};var c=!1;e.dates.startDate.setMonth(e.dates.startDate.getMonth()-12),r(),e.startDateOpened=!1,e.endDateOpened=!1,e.openStartDate=function(){e.startDateOpened=!0},e.openEndDate=function(){e.endDateOpened=!0},e.$watch(function(e){return e.dates.startDate},function(){c&&(s=e.selectedOption,r())}),e.$watch(function(e){return e.dates.endDate},function(){c?(s=e.selectedOption,r()):c=!0}),e.show=function(t){a.insert("salesbyagent/"+t.id,{startDate:e.dates.startDate,endDate:e.dates.endDate,id:t.id},function(a){i=t.id,e.SalesByAgents=a,e.SalesByAgents.startDate=new Date(e.dates.startDate),e.SalesByAgents.endDate=new Date(e.dates.endDate),n.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"app/view/reports/salesbyregionshow.html",controller:"ModalInstanceController",controllerAs:"$modal",scope:e,size:"lg",resolve:{data:function(){return a}}}).result.then(function(){},function(){})})}}])}(),function(){angular.module("Billing").controller("LoginController",["$scope","$rootScope","$http","$location","SessionService","localStorageService","ToasterService","$timeout",function(e,t,n,a,o,r,i,s){function l(){n.defaults.headers.common.Token=credentials.token,n.defaults.headers.common.ApiKey=BillingConfig.apiKey,n.get(BillingConfig.source+"invoices/automatic/nocheck").then(function(e){t.invoicesCount=e.data,s(l,1e4)},function(e){})}n.get("config.json").then(function(e){BillingConfig=e.data,t.invoicesCount=0;var o=r.cookie.get("Billing");null!=o&&n({method:"post",url:BillingConfig.source+"remember",data:{apiKey:BillingConfig.apiKey,signature:BillingConfig.signature,remember:o}}).then(function(e){credentials=e.data,r.cookie.set("Billing",credentials.remember,BillingConfig.ExpirationDate),t.currentUser=credentials.currentUser.name,t.currentUsername=credentials.currentUser.username,t.currentUserId=credentials.currentUser.id,redirectTo="/logout"==redirectTo?BillingConfig.DefaultRoute:redirectTo,a.path(redirectTo),l()},function(e){i.pop("error","Error","Username or password is incorrect")})},function(e){i.pop("error","Error",e)}),$(document).ready(function(){$(".content").hide().fadeIn("slow"),$("#countdown").countdown("2017/05/19 14:00:00",function(e){$(this).html(e.strftime("%Ddays   %Hh %Mm %Ss"))})}),e.login=function(){n.defaults.headers.common.Authorization="Basic "+o.encode(e.user.name+":"+e.user.pass),n({method:"post",url:BillingConfig.source+"login",data:{apiKey:BillingConfig.apiKey,signature:BillingConfig.signature,remember:e.user.remember}}).then(function(n){credentials=n.data,t.currentUser=credentials.currentUser.name,t.currentUsername=credentials.currentUser.username,t.currentUserId=credentials.currentUser.id,e.user.remember&&r.cookie.set("Billing",credentials.remember,BillingConfig.ExpirationDate),redirectTo="/logout"==redirectTo?BillingConfig.DefaultRoute:redirectTo,l(),a.path(redirectTo)},function(e){document.getElementById("username").style.border="2px solid #f00",document.getElementById("password").style.border="2px solid #f00",i.pop("error","Error","Username or password is incorrect"),credentials=null})},t.getClass=function(e){return a.path()===e?"active-menu":""},$("a.page-scroll").bind("click",function(e){var t=$(this);$("html, body").stop().animate({scrollTop:$(t.attr("href")).offset().top-50},1250,"easeInOutExpo"),e.preventDefault()}),$("body").scrollspy({target:".navbar-fixed-top",offset:51}),$(".navbar-collapse ul li a").click(function(){$(".navbar-toggle:visible").click()}),$("#mainNav").affix({offset:{top:100}}),$("#contactForm input,#contactForm textarea").jqBootstrapValidation({preventSubmit:!0,submitError:function(e,t,n){},submitSuccess:function(e,t){t.preventDefault();var n=$("input#name").val(),a=$("input#email").val(),o=$("input#phone").val(),r=$("textarea#message").val(),i=n;i.indexOf(" ")>=0&&(i=n.split(" ").slice(0,-1).join(" ")),$.ajax({url:"././mail/contact_me.php",type:"POST",data:{name:n,phone:o,email:a,message:r},cache:!1,success:function(){$("#success").html("<div class='alert alert-success'>"),$("#success > .alert-success").html("<button type='button' class='close' data-dismiss='alert' aria-hidden='true'>&times;").append("</button>"),$("#success > .alert-success").append("<strong>Your message has been sent. </strong>"),$("#success > .alert-success").append("</div>"),$("#contactForm").trigger("reset")},error:function(){$("#success").html("<div class='alert alert-danger'>"),$("#success > .alert-danger").html("<button type='button' class='close' data-dismiss='alert' aria-hidden='true'>&times;").append("</button>"),$("#success > .alert-danger").append($("<strong>").text("Sorry "+i+", it seems that my mail server is not responding. Please try again later!")),$("#success > .alert-danger").append("</div>"),$("#contactForm").trigger("reset")}})},filter:function(){return $(this).is(":visible")}}),$('a[data-toggle="tab"]').click(function(e){e.preventDefault(),$(this).tab("show")}),$("#name").focus(function(){$("#success").html("")})}]).controller("LogoutController",["$http","localStorageService",function(e,t){e({method:"get",url:BillingConfig.source+"logout",async:!1}).then(function(e){return t.cookie.clearAll("Billing"),credentials=null,window.location.reload(),!0},function(e){return!1})}])}(),function(){angular.module("Billing").controller("ShippersController",["$scope","$http","$uibModal","DataFactory","ToasterService","ShippersFactory",function(e,t,n,a,o,r){function i(){e.pageParams.page=e.pageParams.page-1,a.list("shippers",function(t){e.shippers=t.list,e.pageParams.totalItems=t.totalItems,e.pageParams.page=t.currentPage+1},e.pageParams)}e.maxPagination=BillingConfig.maxPagination,e.pageParams={page:1,showPerPage:BillingConfig.showPerPage,sortType:"name",sortReverse:!1,totalItems:0},e.sort=function(t){e.pageParams.sortType===t&&(e.pageParams.sortReverse=!e.pageParams.sortReverse),e.pageParams.sortType=t,i()},e.search=function(){(e.pageParams.name.toString().length>2||0==e.pageParams.name.toString().length)&&i()},e.showItems=function(){i()},e.pageChanged=function(){i()},i(),e.new=function(){n.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"app/view/shippers/new.html",controller:"ModalInstanceController",controllerAs:"$modal",resolve:{data:function(){return r.empty()}}}).result.then(function(e){a.insert("shippers",r.shipper(e),function(e){o.pop("success","Success","Shipper added"),i()})},function(){})},e.show=function(e){n.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"app/view/shippers/show.html",controller:"ModalInstanceController",controllerAs:"$modal",resolve:{data:function(){return e}}}).result.then(function(){},function(){})},e.edit=function(e){n.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"app/view/shippers/edit.html",controller:"ModalInstanceController",controllerAs:"$modal",resolve:{data:function(){return $.extend(!0,{},e)}}}).result.then(function(e){a.update("shippers",e.id,r.shipper(e),function(e){o.pop("success","Success","Shipper saved"),i()})},function(){})},e.delete=function(e){n.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"app/view/shippers/delete.html",controller:"ModalInstanceController",controllerAs:"$modal",resolve:{data:function(){return e}}}).result.then(function(e){a.delete("shippers",e.id,function(e){o.pop("success","Success","Shipper deleted"),i()})},function(){})}}])}(),function(){angular.module("Billing").controller("StocksController",["$scope","$http","$uibModal","DataFactory","ToasterService",function(e,t,n,a,o){function r(){e.pageParams.page=e.pageParams.page-1,a.list("stocks",function(t){e.stocks=t.list,e.pageParams.totalItems=t.totalItems,e.pageParams.page=t.currentPage+1},e.pageParams)}e.maxPagination=BillingConfig.maxPagination,e.pageParams={page:1,showPerPage:BillingConfig.showPerPage,sortType:"product.name",sortReverse:!1,totalItems:0},e.sort=function(t){e.pageParams.sortType===t&&(e.pageParams.sortReverse=!e.pageParams.sortReverse),e.pageParams.sortType=t,r()},e.search=function(){(e.pageParams.name.toString().length>2||0==e.pageParams.name.toString().length)&&r()},e.showItems=function(){r()},e.pageChanged=function(){r()},r()}])}(),function(){angular.module("Billing").controller("SuppliersController",["$scope","$http","$uibModal","DataFactory","ToasterService","SuppliersFactory",function(e,t,n,a,o,r){function i(){e.pageParams.page=e.pageParams.page-1,a.list("suppliers",function(t){e.suppliers=t.list,e.pageParams.totalItems=t.totalItems,e.pageParams.page=t.currentPage+1},e.pageParams)}e.maxPagination=BillingConfig.maxPagination,e.pageParams={page:1,showPerPage:BillingConfig.showPerPage,sortType:"name",sortReverse:!1,totalItems:0},e.sort=function(t){e.pageParams.sortType===t&&(e.pageParams.sortReverse=!e.pageParams.sortReverse),e.pageParams.sortType=t,i()},e.search=function(){(e.pageParams.name.toString().length>2||0==e.pageParams.name.toString().length)&&i()},e.showItems=function(){i()},e.pageChanged=function(){i()},i(),e.new=function(){n.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"app/view/suppliers/new.html",controller:"ModalInstanceController",controllerAs:"$modal",resolve:{data:function(){return r.empty()}}}).result.then(function(e){a.insert("suppliers",r.supplier(e),function(e){o.pop("success","Success","Supplier added"),i()})},function(){})},e.show=function(e){n.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"app/view/suppliers/show.html",controller:"ModalInstanceController",controllerAs:"$modal",resolve:{data:function(){return e}}}).result.then(function(){},function(){})},e.edit=function(e){n.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"app/view/suppliers/edit.html",controller:"ModalInstanceController",controllerAs:"$modal",resolve:{data:function(){return $.extend(!0,{},e)}}}).result.then(function(e){a.update("suppliers",e.id,r.supplier(e),function(e){o.pop("success","Success","Supplier saved"),i()})},function(){i()})},e.delete=function(e){n.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"app/view/suppliers/delete.html",controller:"ModalInstanceController",controllerAs:"$modal",resolve:{data:function(){return e}}}).result.then(function(e){a.delete("suppliers",e.id,function(e){o.pop("success","Success","Supplier deleted"),i()})},function(){})}}])}(),function(){angular.module("Billing").controller("TownsController",["$scope","$http","$uibModal","DataFactory","ToasterService","TownsFactory",function(e,t,n,a,o,r){function i(){e.pageParams.page=e.pageParams.page-1,a.list("towns",function(t){e.towns=t.list,e.pageParams.totalItems=t.totalItems,e.pageParams.page=t.currentPage+1},e.pageParams)}e.regions=BillingConfig.regions,e.getTown=function(t){e.town=t},e.maxPagination=BillingConfig.maxPagination,e.pageParams={page:1,showPerPage:BillingConfig.showPerPage,sortType:"name",sortReverse:!1,totalItems:0},e.sort=function(t){e.pageParams.sortType===t&&(e.pageParams.sortReverse=!e.pageParams.sortReverse),e.pageParams.sortType=t,i()},e.search=function(){(e.pageParams.name.toString().length>2||0==e.pageParams.name.toString().length)&&i()},e.showItems=function(){i()},e.pageChanged=function(){i()},i(),e.new=function(){n.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"app/view/towns/new.html",controller:"ModalInstanceController",controllerAs:"$modal",resolve:{data:function(){return r.empty()}}}).result.then(function(e){a.insert("towns",r.town(e),function(e){o.pop("success","Success","Town added"),i()})},function(){})},e.edit=function(e){n.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"app/view/towns/edit.html",controller:"ModalInstanceController",controllerAs:"$modal",resolve:{data:function(){return r.town(e)}}}).result.then(function(e){a.update("towns",e.id,r.town(e),function(e){o.pop("success","Success","Town saved"),i()})},function(){})},e.delete=function(e){n.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"app/view/towns/delete.html",controller:"ModalInstanceController",controllerAs:"$modal",resolve:{data:function(){return e}}}).result.then(function(e){a.delete("towns",e.id,function(e){o.pop("success","Success","Town deleted"),i()})},function(){})}}])}(),function(){angular.module("Billing").directive("adminAccess",function(){return{scope:{owner:"="},restrict:"A",link:function(e,t,n){if(!(credentials.currentUser.roles.indexOf("admin")>-1)){var a=credentials.currentUser.id;e.owner!=a&&t.remove()}}}})}(),function(){angular.module("Billing").directive("spinner",["$rootScope",function(e){return function(e,t,n){return e.$on("loader_show",function(){return t.css("display","block")}),e.$on("loader_hide",function(){return t.css("display","none")})}}])}(),function(){angular.module("Billing").directive("toasterContainer",["$compile","$timeout","ToasterService",function(e,t,n){return{replace:!0,restrict:"EA",link:function(e,a,o){function r(t){t.type=l[t.type],t.type||(t.type="toast-info"),s++,angular.extend(t,{id:s}),i(t,5e3),e.toasters.unshift(t)}function i(n,a){n.timeout=t(function(){e.removeToast(n.id)},a)}var s=0,l={error:"toast-error",info:"toast-info",success:"toast-success",warning:"toast-warning"};e.config={position:"toast-bottom-right",title:"toast-title",message:"toast-message",tap:!0},e.toasters=[],e.$on("toaster-newToast",function(){r(n.toast)})},controller:["$scope","$element","$attrs",function(e,n,a){e.stopTimer=function(e){e.timeout&&t.cancel(e.timeout)},e.continueTimer=function(n){n.timeout=t(function(){e.removeToast(n.id)},5e3)},e.removeToast=function(t){var n=0;for(n;n<e.toasters.length&&e.toasters[n].id!==t;n++);e.toasters.splice(n,1)},e.remove=function(t){!0===e.config.tap&&e.removeToast(t)}}],templateUrl:"app/directives/toaster/toaster.html"}}])}(),function(){angular.module("Billing").service("ToasterService",["$rootScope",function(e){this.pop=function(t,n,a){this.toast={type:t,title:n,body:a},e.$broadcast("toaster-newToast")}}])}(),function(){angular.module("Billing").factory("AgentsFactory",function(){return{empty:function(){return{id:0,name:"",towns:[]}},agent:function(e){for(var t=[],n=e.towns.length-1;n>=0;n--)t.push({id:e.towns[n].id,name:e.towns[n].name});return{id:e.id,name:e.name,towns:t}},fullagent:function(e){for(var t=[],n=e.towns.length-1;n>=0;n--)t.push({id:e.towns[n].id,name:e.towns[n].name});return{id:e.id,name:e.name,username:e.username,towns:t,oldPassword:"",newPassword:"",newPasswordAgain:""}}}})}(),function(){angular.module("Billing").factory("CategoriesFactory",function(){return{empty:function(){return{id:0,name:""}},category:function(e){return{id:e.id,name:e.name}}}})}(),function(){angular.module("Billing").factory("CustomersFactory",function(){return{empty:function(){return{id:0,name:"",address:"",town:{id:null,name:""}}},customer:function(e){return{id:e.id,name:e.name,address:e.address,town:{id:e.town.id}}}}})}(),function(){angular.module("Billing").factory("InvoicesFactory",function(){return{invoice:function(e){for(var t=0,n=e.items.length-1;n>=0;n--)t+=e.items[n].subTotal;var a=17*t/100;return{id:e.id,invoiceNo:e.invoiceNo,date:e.date,items:e.items,agent:{id:credentials.currentUser.id,name:credentials.currentUser.name},shipper:{id:e.shipper.id,name:e.shipper.name},customer:{id:e.customer.id,name:e.customer.name,address:e.customer.address,town:{name:e.customer.town.name}},status:e.status,shipping:e.shipping,vat:17,subTotal:t,vatAmount:a,total:t+a+e.shipping}},empty:function(){return{id:0,invoiceNo:"",date:new Date,shipping:0,agent:{id:0,name:""},shipper:{id:0,name:""},customer:{id:0,name:"",address:"",town:{id:0,name:""}},items:[],subTotal:0,vat:17,vatAmout:0}},item:function(e){return{id:0,product:{id:e.id,name:e.name,unit:e.unit},quantity:e.quantity,price:e.price,subTotal:e.quantity*e.price}}}})}(),function(){angular.module("Billing").service("InvoicesService",["$http","ToasterService",function(e,t){var n=BillingConfig.source;return e.defaults.headers.common.Token=credentials.token,e.defaults.headers.common.ApiKey=BillingConfig.apiKey,{next:function(t,a,o){e.get(n+t).then(function(e){return a(e.data)},function(e){return o(e)})},download:function(t){e.get(n+"/invoices/download/"+t,{responseType:"arraybuffer"}).success(function(e){var n=new Blob([e],{type:"application/pdf"});saveAs(n,"Invoice-"+t+"-"+Math.floor(new Date).toString()+".pdf")})}}}])}(),function(){angular.module("Billing").factory("ProcurementsFactory",function(){return{empty:function(){return{id:0,document:"",date:new Date,product:{id:null,name:""},supplier:{id:null,name:""},quantity:null,price:null}},procurement:function(e){return{id:e.id,document:e.document,date:new Date(e.date),product:{id:e.product.id},supplier:{id:e.supplier.id},quantity:e.quantity,price:e.price}}}})}(),function(){angular.module("Billing").factory("ProductsFactory",function(){return{empty:function(){return{id:0,name:"",unit:"",price:null,category:{id:null,name:""}}},product:function(e){return{id:e.id,name:e.name,unit:e.unit,price:e.price,category:{id:e.category.id}}}}})}(),function(){angular.module("Billing").factory("DashboardFactory",function(){var e=BillingConfig.regions,t=BillingConfig.months;return{monthSale:function(e){for(var t=[],n=e.length-1;n>=0;n--)t.push({key:e[n].label,value:e[n].sales});return{data:t,options:{chart:{type:"pieChart",height:650,x:function(e){return e.key},y:function(e){return e.value},showLabels:!0,duration:500,labelThreshold:.01,labelSunbeamLayout:!0}}}},regionsYear:function(e){data=[];for(var n=e.length-1;n>=0;n--){for(var a={key:e[n].label,values:[]},o=0;o<e[n].sales.length;o++){var r=t[o];a.values.push({x:r,y:e[n].sales[o]})}data.push(a)}return{data:data,options:{chart:{type:"multiBarChart",height:650,margin:{top:20,right:100,bottom:100,left:100},x:function(e){return e.x},valueFormat:function(e){return d3.format("$,.2f")(e)},clipEdge:!0,duration:500,stacked:!1,xAxis:{rotateLabels:45}}}}},products:function(e){for(var t=[],n=e.length-1;n>=0;n--)t.push({key:e[n].product,value:e[n]});return{data:t,options:{chart:{type:"pieChart",height:650,x:function(e){return e.key},y:function(e){return e.value.revenue},tooltip:{contentGenerator:function(e){var t=e.data.value,n="<p><strong>Debit: </strong>"+d3.format("$,.2f")(t.revenue.toFixed(2))+"</strong></p>";return n+="<p><strong>Quantity: </strong>"+t.quantity+"</strong></p>"}},showLabels:!0,duration:500,labelThreshold:.01,labelSunbeamLayout:!0}}}},invoices:function(e){for(var t=[],n=e.length-1;n>=0;n--)t.push({key:e[n].status.split(/(?=[A-Z])/).join(" "),value:e[n].count});return{data:t,options:{chart:{type:"pieChart",height:650,x:function(e){return e.key},y:function(e){return e.value},valueFormat:function(e){return Math.floor(e)},showLabels:!0,duration:500,labelThreshold:.01,labelSunbeamLayout:!0}}}},customers:function(e){for(var t=[],n=e.length-1;n>=0;n--)t.push({key:e[n].name,y:e[n]});return{data:t,options:{chart:{type:"pieChart",height:650,x:function(e){return e.key},y:function(e){return e.y.debit},tooltip:{contentGenerator:function(e){var t=e.data.y,n="<p><strong>Credit: </strong>"+d3.format("$,.2f")(t.credit.toFixed(2))+"</strong></p>";return n+="<p><strong>Debit: </strong>"+d3.format("$,.2f")(t.debit.toFixed(2))+"</strong></p>"}},showLabels:!0,duration:500,labelThreshold:.01,labelSunbeamLayout:!0}}}},categoriesyear:function(e){data=[];for(var n=e.length-1;n>=0;n--){for(var a={key:e[n].label,values:[]},o=0;o<e[n].sales.length;o++){var r=t[o];a.values.push({x:r,y:e[n].sales[o]})}data.push(a)}return{data:data,options:{chart:{type:"multiBarChart",height:650,margin:{top:20,right:100,bottom:100,left:100},x:function(e){return e.x},valueFormat:function(e){return d3.format("$,.2f")(e)},clipEdge:!0,duration:500,stacked:!1,xAxis:{rotateLabels:45}}}}},burningitems:function(e){for(var t=[],n=e.length-1;n>=0;n--)t.push({key:e[n].name,y:e[n]});return{data:t,options:{chart:{type:"pieChart",height:650,x:function(e){return e.key},y:function(e){return e.y.sold},tooltip:{contentGenerator:function(e){var t=e.data.y,n="<p><strong>Ordered: </strong>"+t.ordered+"</strong></p>";return n+="<p><strong>Sold: </strong>"+t.sold+"</strong></p>",n+="<p><strong>Stock: </strong>"+t.stock+"</strong></p>"}},showLabels:!0,duration:500,labelThreshold:.01,labelSunbeamLayout:!0}}}},agentsales:function(t){data=[];for(var n=t.length-1;n>=0;n--){for(var a={key:t[n].label,values:[]},o=t[n].sales.length-1;o>=0;o--){var r=e[o];a.values.push({x:r,y:t[n].sales[o]})}data.push(a)}return{data:data,options:{chart:{type:"multiBarChart",height:650,margin:{top:20,right:100,bottom:100,left:100},x:function(e){return e.x},valueFormat:function(e){return d3.format("$,.2f")(e)},clipEdge:!0,duration:500,stacked:!1,xAxis:{rotateLabels:30},yAxis:{axisLabelDistance:50}}}}}}})}(),function(){var e=angular.module("Billing"),t=function(){this.encode=function(e){var t,n,a,o,r,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",s="",l="",c="",u=0;do{t=e.charCodeAt(u++),n=e.charCodeAt(u++),l=e.charCodeAt(u++),a=t>>2,o=(3&t)<<4|n>>4,r=(15&n)<<2|l>>6,c=63&l,isNaN(n)?r=c=64:isNaN(l)&&(c=64),s=s+i.charAt(a)+i.charAt(o)+i.charAt(r)+i.charAt(c),t=n=l="",a=o=r=c=""}while(u<e.length);return s},this.decode=function(e){var t,n,a,o,r,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",s="",l="",c="",u=0;/[^A-Za-z0-9\+\/\=]/g.exec(e)&&window.alert("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='\nExpect errors in decoding."),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{a=i.indexOf(e.charAt(u++)),o=i.indexOf(e.charAt(u++)),r=i.indexOf(e.charAt(u++)),c=i.indexOf(e.charAt(u++)),t=a<<2|o>>4,n=(15&o)<<4|r>>2,l=(3&r)<<6|c,s+=String.fromCharCode(t),64!=r&&(s+=String.fromCharCode(n)),64!=c&&(s+=String.fromCharCode(l)),t=n=l="",a=o=r=c=""}while(u<e.length);return s}};e.service("SessionService",t)}(),function(){angular.module("Billing").factory("ShippersFactory",function(){return{empty:function(){return{id:0,name:"",address:"",town:{id:null,name:""}}},shipper:function(e){return{id:e.id,name:e.name,address:e.address,town:{id:e.town.id}}}}})}(),function(){angular.module("Billing").factory("SuppliersFactory",function(){return{empty:function(){return{id:0,name:"",address:"",town:{id:null,name:""}}},supplier:function(e){return{id:e.id,name:e.name,address:e.address,town:{id:e.town.id}}}}})}(),function(){angular.module("Billing").factory("TownsFactory",function(){return{empty:function(){return{id:0,name:"",zip:"",region:null}},town:function(e){return{id:e.id,name:e.name,zip:e.zip,region:e.region}}}})}();